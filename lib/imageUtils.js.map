{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/lib/type.ts","webpack:///./src/lib/imageUtils.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","10","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","oldJsonpFunction","slice","GenericType","ImageUtilsType","StrTrimType","FontStyle","TextType","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","step","next","e","rejected","done","then","ImageUtils","backgroud","persent","this","canvas","context","mainResource","canvasWidth","canvasHeight","resourceList","resourse","src","image","Image","crossOrigin","onload","assign","ref","onerror","LogUtils","logError","radio","width","height","drawImage","restore","newImageInfo","left","top","save","needRound","arc","Math","PI","clip","document","createElement","getContext","loadResourse","composeMainResource","composeQueue","resourceL","reduce","total","item","index","type","content","font","fanmily","fillStyle","color","fillText","all","resolveQueue","forEach","renderResource","convertCanvasToImage","toDataURL","logSuccess"],"mappings":"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","file":"imageUtils.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t10: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([31,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export var GenericType;\n(function (GenericType) {\n    let StrTrimType;\n    (function (StrTrimType) {\n        /** 去除首尾字符 */\n        StrTrimType[StrTrimType[\"LEFT_RIGHT\"] = 0] = \"LEFT_RIGHT\";\n        /** 去除所有空格 */\n        StrTrimType[StrTrimType[\"ALL\"] = 1] = \"ALL\";\n        /** 去除左边的空格 */\n        StrTrimType[StrTrimType[\"LEFT\"] = 2] = \"LEFT\";\n        /** 去除右边课空格 */\n        StrTrimType[StrTrimType[\"RIGHT\"] = 3] = \"RIGHT\";\n    })(StrTrimType = GenericType.StrTrimType || (GenericType.StrTrimType = {}));\n})(GenericType || (GenericType = {}));\nexport var ImageUtilsType;\n(function (ImageUtilsType) {\n    let FontStyle;\n    (function (FontStyle) {\n        FontStyle[\"fanmily\"] = \"14px Arial\";\n        FontStyle[\"color\"] = \"#d4546f\";\n    })(FontStyle = ImageUtilsType.FontStyle || (ImageUtilsType.FontStyle = {}));\n    let TextType;\n    (function (TextType) {\n        TextType[\"Text\"] = \"text\";\n        TextType[\"Image\"] = \"image\";\n    })(TextType = ImageUtilsType.TextType || (ImageUtilsType.TextType = {}));\n})(ImageUtilsType || (ImageUtilsType = {}));\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/**\n * 图片合成等操作\n */\nimport LogUtils from './logUtils';\nimport { ImageUtilsType } from './type';\nexport default class ImageUtils {\n    constructor(backgroud, persent) {\n        /**\n         * 基于当前屏幕的比例\n         */\n        this.persent = 1;\n        /**\n         * canvas的元素\n         */\n        this.canvas = null;\n        /**\n         * context canvas 上下文\n         */\n        this.context = null;\n        /**\n         * 合并的背景地址\n         */\n        this.mainResource = '';\n        /**\n         * canvas的宽度  实际上数合并背景的宽度\n         */\n        this.canvasWidth = 0;\n        /**\n         * canvas的高度  实际上数合并背景的高度\n         */\n        this.canvasHeight = 0;\n        /**\n         * 资源列表\n         */\n        this.resourceList = [];\n        this.mainResource = backgroud;\n        if (persent) {\n            this.persent = persent;\n        }\n    }\n    addSourse(resourse) {\n        this.resourceList.push(resourse);\n        return this;\n    }\n    /**\n     * 加载图片\n     */\n    loadResourse(src, resourse) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const image = new Image();\n            image.crossOrigin = 'anonymous';\n            image.src = src;\n            return new Promise((resolve, reject) => {\n                image.onload = () => {\n                    const result = resourse ? Object.assign({ ref: image }, resourse) : image;\n                    resolve(result);\n                };\n                image.onerror = () => {\n                    LogUtils.logError(src, '[d-utils] ImageUtils loadResourse 裁剪图片加载错误');\n                    reject();\n                };\n            });\n        });\n    }\n    composeMainResource(image) {\n        const radio = image.width / image.height;\n        this.canvasWidth = image.width * this.persent;\n        this.canvasHeight = this.canvasWidth / radio;\n        // 设置canvas的宽高\n        this.canvas.width = this.canvasWidth;\n        this.canvas.height = this.canvasHeight;\n        this.context.drawImage(image, 0, 0, this.canvasWidth, this.canvasHeight);\n        this.context.restore();\n    }\n    /**\n     * @description cavans绘制效果\n     * @param image addSourse 添加的数据信息\n     */\n    renderResource(image) {\n        const newImageInfo = {\n            left: image.left * this.canvasWidth,\n            top: image.top * this.canvasHeight,\n            width: image.width * this.canvasWidth,\n            height: image.height * this.canvasHeight,\n        };\n        this.context.save();\n        if (image.needRound) {\n            // 走圆形绘制图片 此时都视为正方形\n            this.context.arc(newImageInfo.width / 2 + newImageInfo.left, newImageInfo.width / 2 + newImageInfo.top, newImageInfo.width / 2, 0, Math.PI * 2, false);\n            this.context.clip();\n            this.context.drawImage(image.ref, newImageInfo.left, newImageInfo.top, newImageInfo.width, newImageInfo.width);\n            this.context.restore();\n        }\n        else {\n            // 走正常绘制\n            this.context.drawImage(image.ref, newImageInfo.left, newImageInfo.top, newImageInfo.width, newImageInfo.height);\n            this.context.restore();\n        }\n    }\n    /**\n     * @description 初始化canvas的设置\n     * @return { Promise } 返回合成成功的image对象信息\n     */\n    compose() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.canvas = document.createElement('canvas');\n            this.context = this.canvas.getContext('2d');\n            const mainResource = yield this.loadResourse(this.mainResource);\n            this.composeMainResource(mainResource);\n            // 开始执行\n            const composeQueue = [];\n            const resourceL = this.resourceList.reduce((total, item, index) => {\n                if (item.type === ImageUtilsType.TextType.Image) {\n                    const data = this.loadResourse(item.content, item);\n                    total.push(data);\n                }\n                else {\n                    this.context.font = item.fanmily || ImageUtilsType.FontStyle.fanmily;\n                    this.context.fillStyle = item.color || ImageUtilsType.FontStyle.color;\n                    this.context.fillText(item.content, item.left * this.canvasWidth, item.top * this.canvasHeight);\n                }\n                return total;\n            }, composeQueue);\n            const resolveQueue = yield Promise.all(resourceL);\n            // 再次绘制\n            yield resolveQueue.forEach((item) => {\n                this.renderResource(item);\n            });\n            return Promise.resolve(this.convertCanvasToImage());\n        });\n    }\n    /**\n     * @description canvase转换成图片\n     * @return { Image } 返回一个new Image的实例\n     */\n    convertCanvasToImage() {\n        const image = new Image();\n        image.src = this.canvas.toDataURL('image/png', 1);\n        LogUtils.logSuccess(image, '[d-utils] ImageUtils convertCanvasToImage 图片对象创建成功');\n        return image;\n    }\n}\n"],"sourceRoot":""}